# Plan 03-02: Integrate Formspree for Email Submission

## Overview

Integrate Formspree email service to handle contact form submissions. This enables quote requests to be sent via email without requiring a backend server.

## Why This Matters

Validated forms (from Plan 03-01) are useless without submission handling. Formspree provides a production-ready email service that works with static sites, handling spam protection, delivery, and submission storage.

## Research Summary

**Service selected: Formspree** (recommendation from discovery research)

**Why Formspree:**
- Purpose-built for static sites with no backend required
- Official React SDK (`@formspree/react`) with clean integration
- Built-in spam protection (Akismet) and submission storage
- Free tier: 50 submissions/month (sufficient for freelance portfolio)
- Professional features: auto-responses, custom templates, file uploads
- Lower maintenance than EmailJS (no exposed API keys in client)
- Better static site support than Resend (which requires backend)

**Alternatives considered:**
- EmailJS: 200 emails/month but exposes API keys, reliability depends on email provider
- Resend: Requires backend server, not suitable for static deployment

## Tasks

- [ ] **Task 1**: Create Formspree account and form endpoint
  - Sign up at formspree.io
  - Create new form project ("Freelance Portfolio Contact")
  - Get form ID (format: `{form_id}`)
  - Configure form settings:
    - Enable spam protection (Akismet)
    - Set notification email
    - Configure auto-response (optional)
  - Store form ID securely (environment variable or config)
  - Files: `.env.local` (new, gitignored)

- [ ] **Task 2**: Install Formspree React SDK
  - Install `@formspree/react` package
  - Verify installation in package.json
  - Files: `package.json`, `pnpm-lock.yaml`

- [ ] **Task 3**: Create Formspree configuration
  - Create config file with form ID
  - Export form ID for use in components
  - Document configuration in README
  - Files: `src/config/formspree.ts` (new), `README.md`

- [ ] **Task 4**: Integrate Formspree with Contact.tsx
  - Import `useForm` from @formspree/react
  - Connect Formspree submission to react-hook-form `handleSubmit`
  - Add submission states: loading, success, error
  - Disable submit button during loading
  - Display success message after submission
  - Display error message on failure
  - Reset form after successful submission
  - Files: `src/app/components/Contact.tsx`

- [ ] **Task 5**: Integrate Formspree with ContactV2.tsx
  - Apply same integration pattern as V1
  - Ensure consistent UI states across versions
  - Files: `src/app/components/v2/ContactV2.tsx`

- [ ] **Task 6**: Add submission UI states
  - Create loading spinner/indicator for submit button
  - Create success message component (bilingual)
  - Create error message component (bilingual)
  - Add animations for state transitions (optional)
  - Files: `src/app/components/Contact.tsx`, `src/app/components/v2/ContactV2.tsx`

- [ ] **Task 7**: Add submission translations
  - Add success message keys to translations
  - Add error message keys to translations
  - Add loading state text to translations
  - Files: `src/locales/en/translation.json`, `src/locales/ko/translation.json`

- [ ] **Task 8**: Test end-to-end submission
  - Test successful form submission
  - Verify email delivery to configured address
  - Test with invalid data (should be blocked by validation from 03-01)
  - Test loading state UI
  - Test success state UI
  - Test error state UI (disconnect network)
  - Test bilingual success/error messages
  - Test form reset after success
  - Check Formspree dashboard for submission data
  - Files: None (manual testing)

- [ ] **Task 9**: Configure auto-response (optional)
  - Set up auto-response email template in Formspree
  - Customize message for both English and Korean
  - Test auto-response delivery
  - Files: Formspree dashboard configuration

- [ ] **Task 10**: Update documentation
  - Document Formspree setup steps in README
  - Document environment variable configuration
  - Add troubleshooting guide for common issues
  - Files: `README.md`

## Acceptance Criteria

- [ ] Formspree account created with form endpoint
- [ ] @formspree/react SDK installed
- [ ] Form ID configured in environment variable
- [ ] Both contact forms successfully submit to Formspree
- [ ] Email notifications are received after submission
- [ ] Loading state is displayed during submission
- [ ] Success message is displayed after successful submission
- [ ] Error message is displayed on submission failure
- [ ] Form resets after successful submission
- [ ] Submit button is disabled during submission
- [ ] Success/error messages are bilingual
- [ ] Submission data appears in Formspree dashboard
- [ ] Build passes with no errors

## Dependencies

- Plan 03-01 complete (form validation)
- Formspree account with form endpoint configured

## Technical Notes

**Formspree React Integration:**
```typescript
import { useForm as useFormspree } from '@formspree/react';
import { useForm } from 'react-hook-form';

// In component:
const [formspreeState, submitToFormspree] = useFormspree(FORMSPREE_FORM_ID);
const { register, handleSubmit, formState: { errors }, reset } = useForm({...});

const onSubmit = async (data: ContactFormData) => {
  await submitToFormspree(data);
  if (!formspreeState.errors) {
    reset(); // Clear form after success
  }
};

// In JSX:
<form onSubmit={handleSubmit(onSubmit)}>
  {/* fields */}
  <Button type="submit" disabled={formspreeState.submitting}>
    {formspreeState.submitting ? t('contact.form.sending') : t('contact.form.submit')}
  </Button>
</form>

{formspreeState.succeeded && (
  <p className="text-green-600">{t('contact.form.success')}</p>
)}

{formspreeState.errors && (
  <p className="text-red-600">{t('contact.form.error')}</p>
)}
```

**Environment Variable:**
```bash
# .env.local
VITE_FORMSPREE_FORM_ID=your_form_id_here
```

**Config File:**
```typescript
// src/config/formspree.ts
export const FORMSPREE_FORM_ID = import.meta.env.VITE_FORMSPREE_FORM_ID;

if (!FORMSPREE_FORM_ID) {
  console.warn('FORMSPREE_FORM_ID is not configured');
}
```

## Important Notes

**Free tier limits:**
- 50 submissions/month
- 30-day data retention
- Sufficient for typical freelance portfolio traffic

**If you exceed limits:**
- Upgrade to Personal plan ($10/mo for 1,000 submissions)
- Or switch to EmailJS (200/month free, but less reliable)

**Security:**
- Form ID is public (safe to expose in client code)
- Formspree handles spam protection server-side
- No sensitive credentials in client code

**This plan requires:**
- User to create Formspree account
- User to provide form ID for configuration

## Estimated Scope

Medium - Integration is straightforward, but requires external account setup and careful state management for loading/success/error UI.
